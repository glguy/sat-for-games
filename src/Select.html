<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# Language TypeFamilies #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{-|
Module      : Select
Description : Symbolic selection of arbitrary values
Copyright   : (c) Eric Mertens, 2018
License     : ISC
Maintainer  : emertens@gmail.com

Symbolic selection from a finite list of alternatives. This module
allows using normal Haskell values symbolically.

We can extract the selected value using either 'runSelect' or
'decode'.

'Select' values can be symbolically compared using comparisons
of their concrete possibilities. For example ('===') will use
('==') on the underlying choices.

&gt;&gt;&gt; :{
solve $
  do let letters = 'a':|&quot;bcdefg&quot;
     x &lt;- selectList letters
     y &lt;- selectList letters
     assert (pure 'c' &lt;? x &amp;&amp; x &lt;? y &amp;&amp; y &lt;? pure 'f')
     return (x,y)
:}
Just ('d','e')

-}</span><span>
</span><a name="line-30"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Select</span><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">(</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-comment">-- * Types</span><span>
</span><a name="line-33"></a><span>    </span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-comment">-- * Operations</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Select.html#runSelect"><span class="hs-identifier hs-var">runSelect</span></a><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Select.html#selectList"><span class="hs-identifier hs-var">selectList</span></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Select.html#selectPermutationN"><span class="hs-identifier hs-var">selectPermutationN</span></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- base</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.OldList.html#tails"><span class="hs-identifier hs-var">tails</span></a><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#NonEmpty"><span class="hs-identifier hs-type">NonEmpty</span></a><span class="hs-special">(</span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3A%7C"><span class="hs-operator hs-var">:|</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">nonEmpty</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- sat-for-games</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="Ersatz.Prelude.html"><span class="hs-identifier">Ersatz.Prelude</span></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="Choice.html"><span class="hs-identifier">Choice</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- | A symbolic choice of regular Haskell values.</span><span>
</span><a name="line-53"></a><span class="hs-keyword">data</span><span> </span><a name="Select"><a href="Select.html#Select"><span class="hs-identifier">Select</span></a></a><span> </span><a name="local-6989586621679107471"><a href="#local-6989586621679107471"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Choose"><a href="Select.html#Choose"><span class="hs-identifier">Choose</span></a></a><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107471"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107471"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span>
</span><a name="line-55"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Value"><a href="Select.html#Value"><span class="hs-identifier">Value</span></a></a><span> </span><a href="#local-6989586621679107471"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-56"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">-- | Delay 'choice' until 'runSelect' or 'decode'.</span><span>
</span><a name="line-59"></a><span class="hs-keyword">instance</span><span> </span><a href="Choice.html#Choice"><span class="hs-identifier hs-type">Choice</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107487"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-60"></a><span>  </span><a name="local-8214565720323818405"><a href="Choice.html#choice"><span class="hs-identifier">choice</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Select.html#Choose"><span class="hs-identifier hs-var">Choose</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | Extract the symbolic value contained in the selection as long as the</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- underlying values support symbolic choice.</span><span>
</span><a name="line-64"></a><span class="hs-identifier">runSelect</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Choice.html#Choice"><span class="hs-identifier hs-type">Choice</span></a><span> </span><a href="#local-6989586621679107492"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107492"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679107492"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-65"></a><a name="runSelect"><a href="Select.html#runSelect"><span class="hs-identifier">runSelect</span></a></a><span> </span><span class="hs-special">(</span><a href="Select.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a name="local-6989586621679107493"><a href="#local-6989586621679107493"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107493"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-66"></a><span class="hs-identifier">runSelect</span><span> </span><span class="hs-special">(</span><a href="Select.html#Choose"><span class="hs-identifier hs-var">Choose</span></a><span> </span><a name="local-6989586621679107494"><a href="#local-6989586621679107494"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679107495"><a href="#local-6989586621679107495"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679107496"><a href="#local-6989586621679107496"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Choice.html#choice"><span class="hs-identifier hs-var">choice</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#runSelect"><span class="hs-identifier hs-var">runSelect</span></a><span> </span><a href="#local-6989586621679107494"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Select.html#runSelect"><span class="hs-identifier hs-var">runSelect</span></a><span> </span><a href="#local-6989586621679107495"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107496"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- | Selected value can be transformed with a function.</span><span>
</span><a name="line-71"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-72"></a><span>  </span><a name="local-3458764513820541101"><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | Multiple selections can be combined into one.</span><span>
</span><a name="line-75"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-76"></a><span>  </span><a name="local-3458764513820541680"><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#pure"><span class="hs-identifier">pure</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Select.html#Value"><span class="hs-identifier hs-var">Value</span></a><span>
</span><a name="line-77"></a><span>  </span><span class="hs-special">(</span><a name="local-3458764513820541679"><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator">&lt;*&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#ap"><span class="hs-identifier hs-var">ap</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- | Selections can be created based on previous selections.</span><span>
</span><a name="line-80"></a><span class="hs-comment">--</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- 'fail' not supported</span><span>
</span><a name="line-82"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-83"></a><span>  </span><a href="Select.html#Choose"><span class="hs-identifier hs-var">Choose</span></a><span> </span><a name="local-6989586621679107481"><a href="#local-6989586621679107481"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679107482"><a href="#local-6989586621679107482"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679107483"><a href="#local-6989586621679107483"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-3458764513820541099"><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator">&gt;&gt;=</span></a></a><span> </span><a name="local-6989586621679107484"><a href="#local-6989586621679107484"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Select.html#Choose"><span class="hs-identifier hs-var">Choose</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107481"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="#local-6989586621679107484"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107482"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="#local-6989586621679107484"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107483"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-84"></a><span>  </span><a href="Select.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a name="local-6989586621679107485"><a href="#local-6989586621679107485"><span class="hs-identifier">x</span></a></a><span>      </span><span class="hs-operator">&gt;&gt;=</span><span> </span><a name="local-6989586621679107486"><a href="#local-6989586621679107486"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107486"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679107485"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- | Create a selection given a list of alternatives.</span><span>
</span><a name="line-89"></a><span class="hs-identifier">selectList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#NonEmpty"><span class="hs-identifier hs-type">NonEmpty</span></a><span> </span><a href="#local-6989586621679107491"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ersatz.Prelude.html#Ersatz"><span class="hs-identifier hs-type">Ersatz</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107491"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-90"></a><a name="selectList"><a href="Select.html#selectList"><span class="hs-identifier">selectList</span></a></a><span> </span><a name="local-6989586621679107497"><a href="#local-6989586621679107497"><span class="hs-identifier">xxs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107498"><span class="hs-identifier hs-var">selectMerge</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="Select.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a href="#local-6989586621679107497"><span class="hs-identifier hs-var">xxs</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-92"></a><span>    </span><span class="hs-identifier">selectMerge</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#NonEmpty"><span class="hs-identifier hs-type">NonEmpty</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107500"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ersatz.Prelude.html#Ersatz"><span class="hs-identifier hs-type">Ersatz</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107500"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>    </span><a name="local-6989586621679107498"><a href="#local-6989586621679107498"><span class="hs-identifier">selectMerge</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679107502"><a href="#local-6989586621679107502"><span class="hs-identifier">x</span></a></a><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3A%7C"><span class="hs-operator hs-var">:|</span></a><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679107502"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-identifier">selectMerge</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679107503"><a href="#local-6989586621679107503"><span class="hs-identifier">x</span></a></a><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3A%7C"><span class="hs-operator hs-var">:|</span></a><a name="local-6989586621679107504"><a href="#local-6989586621679107504"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679107505"><a href="#local-6989586621679107505"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-95"></a><span>      </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679107506"><a href="#local-6989586621679107506"><span class="hs-identifier">b</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Ersatz.Prelude.html#exists"><span class="hs-identifier hs-var">exists</span></a><span>
</span><a name="line-96"></a><span>         </span><a name="local-6989586621679107507"><a href="#local-6989586621679107507"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679107499"><span class="hs-identifier hs-var">selectMergePairs</span></a><span> </span><a href="#local-6989586621679107505"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-97"></a><span>         </span><a href="#local-6989586621679107498"><span class="hs-identifier hs-var">selectMerge</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#Choose"><span class="hs-identifier hs-var">Choose</span></a><span> </span><a href="#local-6989586621679107503"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679107504"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679107506"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3A%7C"><span class="hs-operator hs-var">:|</span></a><span> </span><a href="#local-6989586621679107507"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-identifier">selectMergePairs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107501"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ersatz.Prelude.html#Ersatz"><span class="hs-identifier hs-type">Ersatz</span></a><span> </span><span class="hs-special">[</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107501"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-100"></a><span>    </span><a name="local-6989586621679107499"><a href="#local-6989586621679107499"><span class="hs-identifier">selectMergePairs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679107508"><a href="#local-6989586621679107508"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679107509"><a href="#local-6989586621679107509"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679107510"><a href="#local-6989586621679107510"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-101"></a><span>      </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679107511"><a href="#local-6989586621679107511"><span class="hs-identifier">b</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Ersatz.Prelude.html#exists"><span class="hs-identifier hs-var">exists</span></a><span>
</span><a name="line-102"></a><span>         </span><a name="local-6989586621679107512"><a href="#local-6989586621679107512"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679107499"><span class="hs-identifier hs-var">selectMergePairs</span></a><span> </span><a href="#local-6989586621679107510"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-103"></a><span>         </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#Choose"><span class="hs-identifier hs-var">Choose</span></a><span> </span><a href="#local-6989586621679107508"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679107509"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679107511"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679107512"><span class="hs-identifier hs-var">z'</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-identifier">selectMergePairs</span><span> </span><a name="local-6989586621679107513"><a href="#local-6989586621679107513"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679107513"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Codec.html#Codec"><span class="hs-identifier hs-type">Codec</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107474"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Decoded</span><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107474"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679107474"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-109"></a><span>  </span><a name="local-8214565720323801281"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Codec.html#encode"><span class="hs-identifier">encode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Select.html#Value"><span class="hs-identifier hs-var">Value</span></a><span>
</span><a name="line-110"></a><span>  </span><a name="local-8214565720323801282"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Codec.html#decode"><span class="hs-identifier">decode</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Select.html#Value"><span class="hs-identifier hs-var">Value</span></a><span> </span><a name="local-6989586621679107475"><a href="#local-6989586621679107475"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="#local-6989586621679107475"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-111"></a><span>  </span><span class="hs-identifier">decode</span><span> </span><a name="local-6989586621679107476"><a href="#local-6989586621679107476"><span class="hs-identifier">solution</span></a></a><span> </span><span class="hs-special">(</span><a href="Select.html#Choose"><span class="hs-identifier hs-var">Choose</span></a><span> </span><a name="local-6989586621679107477"><a href="#local-6989586621679107477"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679107478"><a href="#local-6989586621679107478"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679107479"><a href="#local-6989586621679107479"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679107480"><a href="#local-6989586621679107480"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Codec.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679107476"><span class="hs-identifier hs-var">solution</span></a><span> </span><a href="#local-6989586621679107479"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-113"></a><span>       </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Codec.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679107476"><span class="hs-identifier hs-var">solution</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679107480"><span class="hs-identifier hs-var">b'</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679107478"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679107477"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- | Lift a comparison on values to be one on symbolic choices of</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- those values. This is used to implement 'Equatable' and 'Orderable'.</span><span>
</span><a name="line-119"></a><span class="hs-identifier">liftComparison</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107490"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679107490"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107490"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107490"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span>
</span><a name="line-120"></a><a name="liftComparison"><a href="Select.html#liftComparison"><span class="hs-identifier">liftComparison</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679107514"><a href="#local-6989586621679107514"><span class="hs-operator">?</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679107515"><a href="#local-6989586621679107515"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679107516"><a href="#local-6989586621679107516"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Select.html#runSelect"><span class="hs-identifier hs-var">runSelect</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">liftA2</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679107517"><a href="#local-6989586621679107517"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679107518"><a href="#local-6989586621679107518"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107517"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679107514"><span class="hs-operator hs-var">?</span></a><span> </span><a href="#local-6989586621679107518"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107515"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679107516"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | Lift equality on concrete values to equality on symbolic choices.</span><span>
</span><a name="line-123"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679107473"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Equatable.html#Equatable"><span class="hs-identifier hs-type">Equatable</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107473"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720323801180"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Equatable.html#%3D%3D%3D"><span class="hs-operator">===</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Select.html#liftComparison"><span class="hs-identifier hs-var">liftComparison</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | Lift ordering on concrete values to ordering on symbolic choices.</span><span>
</span><a name="line-127"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679107472"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Orderable.html#Orderable"><span class="hs-identifier hs-type">Orderable</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107472"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720323801156"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Orderable.html#%3C%3F"><span class="hs-operator">&lt;?</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Select.html#liftComparison"><span class="hs-identifier hs-var">liftComparison</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720323801155"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Orderable.html#%3C%3D%3F"><span class="hs-operator">&lt;=?</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Select.html#liftComparison"><span class="hs-identifier hs-var">liftComparison</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- | Select an ordered permutation from a list of source elements.</span><span>
</span><a name="line-134"></a><span class="hs-identifier">selectPermutationN</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-135"></a><span>  </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>               </span><span class="hs-comment">{- ^ desired permutation length -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-136"></a><span>  </span><span class="hs-special">[</span><a href="#local-6989586621679107489"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>               </span><span class="hs-comment">{- ^ source elements            -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-137"></a><span>  </span><a href="Ersatz.Prelude.html#Ersatz"><span class="hs-identifier hs-type">Ersatz</span></a><span> </span><span class="hs-special">[</span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107489"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">{- ^ selected permutation       -}</span><span>
</span><a name="line-138"></a><a name="selectPermutationN"><a href="Select.html#selectPermutationN"><span class="hs-identifier">selectPermutationN</span></a></a><span> </span><a name="local-6989586621679107519"><a href="#local-6989586621679107519"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679107520"><a href="#local-6989586621679107520"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-139"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">nonEmpty</span></a><span> </span><a href="#local-6989586621679107520"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-140"></a><span>    </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span>    </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679107521"><a href="#local-6989586621679107521"><span class="hs-identifier">xs1</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-142"></a><span>      </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679107522"><a href="#local-6989586621679107522"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Control.Monad.html#replicateM"><span class="hs-identifier hs-var">replicateM</span></a><span> </span><a href="#local-6989586621679107519"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Select.html#selectList"><span class="hs-identifier hs-var">selectList</span></a><span> </span><a href="#local-6989586621679107521"><span class="hs-identifier hs-var">xs1</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>         </span><a href="Ersatz.Prelude.html#assert"><span class="hs-identifier hs-var">assert</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#nor"><span class="hs-identifier hs-var">nor</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Select.html#sameSelect"><span class="hs-identifier hs-var">sameSelect</span></a><span> </span><a href="#local-6989586621679107523"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679107525"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679107523"><a href="#local-6989586621679107523"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679107524"><a href="#local-6989586621679107524"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.OldList.html#tails"><span class="hs-identifier hs-var">tails</span></a><span> </span><a href="#local-6989586621679107522"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679107525"><a href="#local-6989586621679107525"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679107524"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-144"></a><span>         </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679107522"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Helper function for comparing selections for equality for use</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- in 'selectPermutationN'</span><span>
</span><a name="line-148"></a><span class="hs-identifier">sameSelect</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107488"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Select.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="#local-6989586621679107488"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span>
</span><a name="line-149"></a><a name="sameSelect"><a href="Select.html#sameSelect"><span class="hs-identifier">sameSelect</span></a></a><span> </span><a href="Select.html#Value"><span class="hs-identifier hs-var">Value</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><a href="Select.html#Value"><span class="hs-identifier hs-var">Value</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#true"><span class="hs-identifier hs-var">true</span></a><span>
</span><a name="line-150"></a><span class="hs-identifier">sameSelect</span><span> </span><span class="hs-special">(</span><a href="Select.html#Choose"><span class="hs-identifier hs-var">Choose</span></a><span> </span><a name="local-6989586621679107526"><a href="#local-6989586621679107526"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-6989586621679107527"><a href="#local-6989586621679107527"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679107528"><a href="#local-6989586621679107528"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Select.html#Choose"><span class="hs-identifier hs-var">Choose</span></a><span> </span><a name="local-6989586621679107529"><a href="#local-6989586621679107529"><span class="hs-identifier">f2</span></a></a><span> </span><a name="local-6989586621679107530"><a href="#local-6989586621679107530"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-6989586621679107531"><a href="#local-6989586621679107531"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-151"></a><span>  </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#choose"><span class="hs-identifier hs-var">choose</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#not"><span class="hs-identifier hs-var">not</span></a><span> </span><a href="#local-6989586621679107528"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><a href="Select.html#sameSelect"><span class="hs-identifier hs-var">sameSelect</span></a><span> </span><a href="#local-6989586621679107526"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679107529"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679107528"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><a href="Select.html#sameSelect"><span class="hs-identifier hs-var">sameSelect</span></a><span> </span><a href="#local-6989586621679107527"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679107530"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679107531"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-152"></a><span class="hs-identifier">sameSelect</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;sameSelect: mismatched arguments&quot;</span><span>
</span><a name="line-153"></a></pre></body></html>