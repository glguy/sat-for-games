<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : TotalMap
Description : Ordered maps with a default value
Copyright   : (c) Eric Mertens, 2018
License     : ISC
Maintainer  : emertens@gmail.com

This module implements a total, ordered map. Upon construction of
a new map, a default value must be specified. This value will be
returned for any lookup that has not otherwise been assigned.

Having a built-in default value is particularly useful when working
with symbolic values as ensures every key has a value, so the structure
of the map will not depend on symbolic values.

To construct new 'TotalMap' values, use 'fromList' and 'pure'.

To update 'TotalMap' values, use ('=:') and 'fmap'.

To query 'TotalMap' values, use ('!').

To combine 'TotalMap' values, use 'choice' and ('&lt;*&gt;').

-}</span><span>
</span><a name="line-25"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TotalMap</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TotalMap.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TotalMap.html#%3D%3A"><span class="hs-operator hs-var">=:</span></a><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-comment">-- base</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">liftA2</span></a><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-comment">-- containers</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- sat-for-games</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span>           </span><a href="Choice.html"><span class="hs-identifier">Choice</span></a><span> </span><span class="hs-special">(</span><a href="Choice.html#Choice"><span class="hs-identifier hs-type">Choice</span></a><span class="hs-special">(</span><a href="Choice.html#choice"><span class="hs-identifier hs-var">choice</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- | A total map behaves like a function that can be efficiently updated.</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- The map tracks a default value when created.</span><span>
</span><a name="line-44"></a><span class="hs-keyword">data</span><span> </span><a name="TotalMap"><a href="TotalMap.html#TotalMap"><span class="hs-identifier">TotalMap</span></a></a><span> </span><a name="local-6989586621679112488"><a href="#local-6989586621679112488"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679112489"><a href="#local-6989586621679112489"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TotalMap"><a href="TotalMap.html#TotalMap"><span class="hs-identifier">TotalMap</span></a></a><span> </span><a href="#local-6989586621679112489"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="#local-6989586621679112488"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679112489"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- | Create a 'TotalMap' given a list of key-value pairs</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- and a default value for any unassigned keys. Assignments</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- are processed left-to-right. Later assignments overwrite</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- earlier ones.</span><span>
</span><a name="line-51"></a><span class="hs-comment">--</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- &gt;&gt;&gt; fromList 0 [('a',1), ('b',2)]</span><span>
</span><a name="line-53"></a><span class="hs-comment">-- fromList 0 [('a',1),('b',2)]</span><span>
</span><a name="line-54"></a><span class="hs-comment">--</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- &gt;&gt;&gt; fromList 0 [('a',1), ('a',2)]</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- fromList 0 [('a',2)]</span><span>
</span><a name="line-57"></a><span class="hs-comment">--</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- &gt;&gt;&gt; fromList 0 [('a',0)]</span><span>
</span><a name="line-59"></a><span class="hs-comment">-- fromList 0 [('a',0)]</span><span>
</span><a name="line-60"></a><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-61"></a><span>  </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679112530"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-62"></a><span>  </span><a href="#local-6989586621679112531"><span class="hs-identifier hs-type">v</span></a><span>       </span><span class="hs-comment">{- ^ default value   -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679112530"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679112531"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">{- ^ key-value pairs -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-64"></a><span>  </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span> </span><a href="#local-6989586621679112530"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679112531"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-65"></a><a name="fromList"><a href="TotalMap.html#fromList"><span class="hs-identifier">fromList</span></a></a><span> </span><a name="local-6989586621679112532"><a href="#local-6989586621679112532"><span class="hs-identifier">def</span></a></a><span> </span><a name="local-6989586621679112533"><a href="#local-6989586621679112533"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><a href="#local-6989586621679112532"><span class="hs-identifier hs-var">def</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a><span> </span><a href="#local-6989586621679112533"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">-- | Lookup the value associated with a given key in the map.</span><span>
</span><a name="line-69"></a><span class="hs-comment">--</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- &gt;&gt;&gt; let m = fromList 0 [('a',1), ('b',2)]</span><span>
</span><a name="line-71"></a><span class="hs-comment">--</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- &gt;&gt;&gt; m ! 'b'</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- 2</span><span>
</span><a name="line-74"></a><span class="hs-comment">--</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- &gt;&gt;&gt; m ! 'c'</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- 0</span><span>
</span><a name="line-77"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679112528"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span> </span><a href="#local-6989586621679112528"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679112529"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679112528"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679112529"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-78"></a><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><a name="local-6989586621679112534"><a href="#local-6989586621679112534"><span class="hs-identifier">def</span></a></a><span> </span><a name="local-6989586621679112535"><a href="#local-6989586621679112535"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">!</span><span> </span><a name="local-6989586621679112536"><a href="#local-6989586621679112536"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#findWithDefault"><span class="hs-identifier hs-var">Map.findWithDefault</span></a><span> </span><a href="#local-6989586621679112534"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-6989586621679112536"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679112535"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | Assign a new value to a given key in a map.</span><span>
</span><a name="line-82"></a><span class="hs-comment">--</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- Note that this assignment makes no attempt to avoid duplicating</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- the default value.</span><span>
</span><a name="line-85"></a><span class="hs-comment">--</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- &gt;&gt;&gt; let m = fromList 0 [('a',1), ('b',2)]</span><span>
</span><a name="line-87"></a><span class="hs-comment">--</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- &gt;&gt;&gt; ('b' =: 0) m</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- fromList 0 [('a',1),('b',0)]</span><span>
</span><a name="line-90"></a><span class="hs-comment">--</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- &gt;&gt;&gt; ('b' =: 10) m</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- fromList 0 [('a',1),('b',10)]</span><span>
</span><a name="line-93"></a><span class="hs-comment">--</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- &gt;&gt;&gt; ('c' =: 10) m</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- fromList 0 [('a',1),('b',2),('c',10)]</span><span>
</span><a name="line-96"></a><span class="hs-special">(</span><span class="hs-operator">=:</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679112526"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679112526"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679112527"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span> </span><a href="#local-6989586621679112526"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679112527"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span> </span><a href="#local-6989586621679112526"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679112527"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-97"></a><span class="hs-special">(</span><a name="local-6989586621679112537"><a href="#local-6989586621679112537"><span class="hs-identifier">k</span></a></a><span> </span><a name="%3D%3A"><a href="TotalMap.html#%3D%3A"><span class="hs-operator">=:</span></a></a><span> </span><a name="local-6989586621679112538"><a href="#local-6989586621679112538"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><a name="local-6989586621679112539"><a href="#local-6989586621679112539"><span class="hs-identifier">def</span></a></a><span> </span><a name="local-6989586621679112540"><a href="#local-6989586621679112540"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><a href="#local-6989586621679112539"><span class="hs-identifier hs-var">def</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">Map.insert</span></a><span> </span><a href="#local-6989586621679112537"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679112538"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679112540"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">-- | Symbolic choice between the values stored at each key.</span><span>
</span><a name="line-102"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679112519"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="Choice.html#Choice"><span class="hs-identifier hs-type">Choice</span></a><span> </span><a href="#local-6989586621679112520"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Choice.html#Choice"><span class="hs-identifier hs-type">Choice</span></a><span> </span><span class="hs-special">(</span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span> </span><a href="#local-6989586621679112519"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679112520"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-103"></a><span>  </span><a name="local-8214565720323818405"><a href="Choice.html#choice"><span class="hs-identifier">choice</span></a></a><span> </span><a name="local-6989586621679112521"><a href="#local-6989586621679112521"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679112522"><a href="#local-6989586621679112522"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679112523"><a href="#local-6989586621679112523"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">liftA2</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679112524"><a href="#local-6989586621679112524"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679112525"><a href="#local-6989586621679112525"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Choice.html#choice"><span class="hs-identifier hs-var">choice</span></a><span> </span><a href="#local-6989586621679112524"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679112525"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-6989586621679112523"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679112521"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679112522"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | This instance allows you to apply a function to the values</span><span>
</span><a name="line-108"></a><span class="hs-comment">-- stored in the total map.</span><span>
</span><a name="line-109"></a><span class="hs-comment">--</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- &gt;&gt;&gt; fmap (*2) (fromList 10 [('a',20)])</span><span>
</span><a name="line-111"></a><span class="hs-comment">-- fromList 20 [('a',40)]</span><span>
</span><a name="line-112"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><span class="hs-special">(</span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span> </span><a href="#local-6989586621679112515"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-113"></a><span>  </span><a name="local-3458764513820541101"><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><a name="local-6989586621679112516"><a href="#local-6989586621679112516"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><a name="local-6989586621679112517"><a href="#local-6989586621679112517"><span class="hs-identifier">def</span></a></a><span> </span><a name="local-6989586621679112518"><a href="#local-6989586621679112518"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679112516"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679112517"><span class="hs-identifier hs-var">def</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679112516"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679112518"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">-- | This instance provides point-wise application between</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- two total maps. The meaning of 'pure' is to provide a map</span><span>
</span><a name="line-117"></a><span class="hs-comment">-- that always returns the given value.</span><span>
</span><a name="line-118"></a><span class="hs-comment">--</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- &gt;&gt;&gt; pure 1 :: TotalMap Char Int</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- fromList 1 []</span><span>
</span><a name="line-121"></a><span class="hs-comment">--</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- &gt;&gt;&gt; fromList id [('a',(+1)),('b',subtract 1)] &lt;*&gt; fromList 4 [('b',5), ('c',6)]</span><span>
</span><a name="line-123"></a><span class="hs-comment">-- fromList 4 [('a',5),('b',4),('c',6)]</span><span>
</span><a name="line-124"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679112504"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><span class="hs-special">(</span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span> </span><a href="#local-6989586621679112504"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-125"></a><span>  </span><a name="local-3458764513820541680"><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#pure"><span class="hs-identifier">pure</span></a></a><span> </span><a name="local-6989586621679112505"><a href="#local-6989586621679112505"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><a href="#local-6989586621679112505"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a><span>
</span><a name="line-126"></a><span>  </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><a name="local-6989586621679112506"><a href="#local-6989586621679112506"><span class="hs-identifier">fDef</span></a></a><span> </span><a name="local-6989586621679112507"><a href="#local-6989586621679112507"><span class="hs-identifier">fMap</span></a></a><span> </span><a name="local-3458764513820541679"><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator">&lt;*&gt;</span></a></a><span> </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><a name="local-6989586621679112508"><a href="#local-6989586621679112508"><span class="hs-identifier">xDef</span></a></a><span> </span><a name="local-6989586621679112509"><a href="#local-6989586621679112509"><span class="hs-identifier">xMap</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-127"></a><span>    </span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span>
</span><a name="line-128"></a><span>      </span><span class="hs-special">(</span><a href="#local-6989586621679112506"><span class="hs-identifier hs-var">fDef</span></a><span> </span><a href="#local-6989586621679112508"><span class="hs-identifier hs-var">xDef</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- combine default function and argument</span><span>
</span><a name="line-129"></a><span>      </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#mergeWithKey"><span class="hs-identifier hs-var">Map.mergeWithKey</span></a><span>
</span><a name="line-130"></a><span>         </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679112510"><a href="#local-6989586621679112510"><span class="hs-identifier">_key</span></a></a><span> </span><a name="local-6989586621679112511"><a href="#local-6989586621679112511"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679112512"><a href="#local-6989586621679112512"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679112511"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679112512"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- combine specific function and argument</span><span>
</span><a name="line-131"></a><span>         </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679112513"><a href="#local-6989586621679112513"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679112513"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679112508"><span class="hs-identifier hs-var">xDef</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- use default argument</span><span>
</span><a name="line-132"></a><span>         </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679112514"><a href="#local-6989586621679112514"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679112506"><span class="hs-identifier hs-var">fDef</span></a><span> </span><a href="#local-6989586621679112514"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- use default function</span><span>
</span><a name="line-133"></a><span>         </span><a href="#local-6989586621679112507"><span class="hs-identifier hs-var">fMap</span></a><span> </span><a href="#local-6989586621679112509"><span class="hs-identifier hs-var">xMap</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- No Monad instance is provided because this would require us to be</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- able to enumerate all of the keys in the first argument to (&gt;&gt;=).</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- Enumerating all of the keys to see what the behavior of the second</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- argument of (&gt;&gt;=) might do with them goes beyond the functionality</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- of the 'TotalMap' type.</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- | Show 'TotalMap' using 'fromList' syntax.</span><span>
</span><a name="line-144"></a><span class="hs-comment">--</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- &gt;&gt;&gt; show (fromList 0 [('a',1)])</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- &quot;fromList 0 [('a',1)]&quot;</span><span>
</span><a name="line-147"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><a href="#local-6989586621679112499"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><a href="#local-6989586621679112500"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><span class="hs-special">(</span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span> </span><a href="#local-6989586621679112499"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679112500"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-148"></a><span>  </span><a name="local-8214565720323790360"><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#showsPrec"><span class="hs-identifier">showsPrec</span></a></a><span> </span><a name="local-6989586621679112501"><a href="#local-6989586621679112501"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-var">TotalMap</span></a><span> </span><a name="local-6989586621679112502"><a href="#local-6989586621679112502"><span class="hs-identifier">def</span></a></a><span> </span><a name="local-6989586621679112503"><a href="#local-6989586621679112503"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#showParen"><span class="hs-identifier hs-var">showParen</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679112501"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a><span> </span><span class="hs-number">11</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>    </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#showString"><span class="hs-identifier hs-var">showString</span></a><span> </span><span class="hs-string">&quot;fromList &quot;</span><span>
</span><a name="line-151"></a><span>    </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#showsPrec"><span class="hs-identifier hs-var">showsPrec</span></a><span> </span><span class="hs-number">11</span><span> </span><a href="#local-6989586621679112502"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-152"></a><span>    </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#showString"><span class="hs-identifier hs-var">showString</span></a><span> </span><span class="hs-string">&quot; &quot;</span><span>
</span><a name="line-153"></a><span>    </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#shows"><span class="hs-identifier hs-var">shows</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a><span> </span><a href="#local-6989586621679112503"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-comment">-- | Read 'TotalMap' using 'fromList' syntax.</span><span>
</span><a name="line-156"></a><span class="hs-comment">--</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- &gt;&gt;&gt; read &quot;fromList 0 [('a',1)]&quot; :: TotalMap Char Int</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- fromList 0 [('a',1)]</span><span>
</span><a name="line-159"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679112490"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span> </span><a href="#local-6989586621679112490"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span> </span><a href="#local-6989586621679112491"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span> </span><span class="hs-special">(</span><a href="TotalMap.html#TotalMap"><span class="hs-identifier hs-type">TotalMap</span></a><span> </span><a href="#local-6989586621679112490"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679112491"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-160"></a><span>  </span><a name="local-8214565720323790064"><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#readsPrec"><span class="hs-identifier">readsPrec</span></a></a><span> </span><a name="local-6989586621679112492"><a href="#local-6989586621679112492"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-161"></a><span>    </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#readParen"><span class="hs-identifier hs-var">readParen</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679112492"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a><span> </span><span class="hs-number">11</span><span class="hs-special">)</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679112493"><a href="#local-6989586621679112493"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-162"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="TotalMap.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span> </span><a href="#local-6989586621679112495"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679112497"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679112498"><span class="hs-identifier hs-var">s3</span></a><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;fromList&quot;</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679112494"><a href="#local-6989586621679112494"><span class="hs-identifier">s1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#lex"><span class="hs-identifier hs-var">lex</span></a><span> </span><a href="#local-6989586621679112493"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-164"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679112495"><a href="#local-6989586621679112495"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679112496"><a href="#local-6989586621679112496"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#readsPrec"><span class="hs-identifier hs-var">readsPrec</span></a><span> </span><span class="hs-number">11</span><span> </span><a href="#local-6989586621679112494"><span class="hs-identifier hs-var">s1</span></a><span>
</span><a name="line-165"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679112497"><a href="#local-6989586621679112497"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679112498"><a href="#local-6989586621679112498"><span class="hs-identifier">s3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#readsPrec"><span class="hs-identifier hs-var">readsPrec</span></a><span> </span><span class="hs-number">11</span><span> </span><a href="#local-6989586621679112496"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-166"></a></pre></body></html>