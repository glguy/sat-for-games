<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : LightsOut
Description : Solver for Lights Out puzzle
Copyright   : (c) Eric Mertens, 2018
License     : ISC
Maintainer  : emertens@gmail.com

https://en.wikipedia.org/wiki/Lights_Out_(game)

This module implements a solver for the Lights Out game. The solver
works by encoding the lights out problem in terms of boolean satisfiability
using the Ersatz library.

This module does not attempt to produce a solution with the minimal number
of button presses. This enhancement is left as an exercise for the reader!

-}</span><span>
</span><a name="line-18"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">LightsOut</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">-- base</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- handled by Ersatz.Prelude</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-comment">-- containers</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-comment">-- sat-for-games</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span>           </span><a href="Ersatz.Prelude.html"><span class="hs-identifier">Ersatz.Prelude</span></a><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- | Specification of a Lights Out puzzle</span><span>
</span><a name="line-35"></a><span class="hs-keyword">data</span><span> </span><a name="LightsOut"><a href="LightsOut.html#LightsOut"><span class="hs-identifier">LightsOut</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LightsOut"><a href="LightsOut.html#LightsOut"><span class="hs-identifier">LightsOut</span></a></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="dimensions"><a href="LightsOut.html#dimensions"><span class="hs-identifier">dimensions</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="LightsOut.html#Dim"><span class="hs-identifier hs-type">Dim</span></a><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="lightsOn"><a href="LightsOut.html#lightsOn"><span class="hs-identifier">lightsOn</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a><span> </span><a href="LightsOut.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">-- | Example puzzle that spells ICFP.</span><span>
</span><a name="line-41"></a><span class="hs-identifier">exampleLightsOut</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="LightsOut.html#LightsOut"><span class="hs-identifier hs-type">LightsOut</span></a><span>
</span><a name="line-42"></a><a name="exampleLightsOut"><a href="LightsOut.html#exampleLightsOut"><span class="hs-identifier">exampleLightsOut</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LightsOut.html#parsePuzzle"><span class="hs-identifier hs-var">parsePuzzle</span></a><span>
</span><a name="line-43"></a><span>  </span><span class="hs-string">&quot;***..***..***..**.\n\
  \.*...*....*....*.*\n\
  \.*...*....**...**.\n\
  \.*...*....*....*..\n\
  \***..***..*....*..\n&quot;</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-- | Small 3-by-3 puzzle</span><span>
</span><a name="line-50"></a><span class="hs-identifier">smallLightsOut</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="LightsOut.html#LightsOut"><span class="hs-identifier hs-type">LightsOut</span></a><span>
</span><a name="line-51"></a><a name="smallLightsOut"><a href="LightsOut.html#smallLightsOut"><span class="hs-identifier">smallLightsOut</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LightsOut.html#parsePuzzle"><span class="hs-identifier hs-var">parsePuzzle</span></a><span>
</span><a name="line-52"></a><span>  </span><span class="hs-string">&quot;**.\n\
  \*.*\n\
  \.**\n&quot;</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- | Example of a puzzle that has no solution.</span><span>
</span><a name="line-57"></a><span class="hs-identifier">unsolvableLightsOut</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="LightsOut.html#LightsOut"><span class="hs-identifier hs-type">LightsOut</span></a><span>
</span><a name="line-58"></a><a name="unsolvableLightsOut"><a href="LightsOut.html#unsolvableLightsOut"><span class="hs-identifier">unsolvableLightsOut</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LightsOut.html#parsePuzzle"><span class="hs-identifier hs-var">parsePuzzle</span></a><span>
</span><a name="line-59"></a><span>  </span><span class="hs-string">&quot;*....\n\
  \*....\n\
  \.....\n\
  \.....\n\
  \.....\n&quot;</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- | Grid coordinate</span><span>
</span><a name="line-68"></a><span class="hs-keyword">data</span><span> </span><a name="Coord"><a href="LightsOut.html#Coord"><span class="hs-identifier">Coord</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="C"><a href="LightsOut.html#C"><span class="hs-identifier">C</span></a></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-comment">-- ^ column row</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- | Cardinal direction neighborhood for a coordinate. Results include</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- the given coordinate.</span><span>
</span><a name="line-73"></a><span class="hs-comment">--</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- &gt;&gt;&gt; neighborhood (C 2 3)</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- [C 2 2,C 1 3,C 2 3,C 3 3,C 2 4]</span><span>
</span><a name="line-76"></a><span class="hs-identifier">neighborhood</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-77"></a><span>  </span><a href="LightsOut.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span>   </span><span class="hs-comment">{- ^ coordinate                     -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-78"></a><span>  </span><span class="hs-special">[</span><a href="LightsOut.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">{- ^ north, west, self, east, south -}</span><span>
</span><a name="line-79"></a><a name="neighborhood"><a href="LightsOut.html#neighborhood"><span class="hs-identifier">neighborhood</span></a></a><span> </span><span class="hs-special">(</span><a href="LightsOut.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a name="local-6989586621679105873"><a href="#local-6989586621679105873"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679105874"><a href="#local-6989586621679105874"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-special">[</span><span>            </span><a href="LightsOut.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679105873"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105874"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="LightsOut.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105873"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679105874"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="LightsOut.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679105873"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105874"><span class="hs-identifier hs-var">y</span></a><span>    </span><span class="hs-special">,</span><span> </span><a href="LightsOut.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105873"><span class="hs-identifier hs-var">x</span></a><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679105874"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-82"></a><span>  </span><span class="hs-special">,</span><span>            </span><a href="LightsOut.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679105873"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105874"><span class="hs-identifier hs-var">y</span></a><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | Board dimensions</span><span>
</span><a name="line-87"></a><span class="hs-keyword">data</span><span> </span><a name="Dim"><a href="LightsOut.html#Dim"><span class="hs-identifier">Dim</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Dim"><a href="LightsOut.html#Dim"><span class="hs-identifier">Dim</span></a></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-comment">-- ^ width height</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">,</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">-- | Generate a list of all coordinates in a board of the given size.</span><span>
</span><a name="line-91"></a><span class="hs-comment">--</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- &gt;&gt;&gt; dimCoords (Dim 3 2)</span><span>
</span><a name="line-93"></a><span class="hs-comment">-- [C 1 1,C 1 2,C 2 1,C 2 2,C 3 1,C 3 2]</span><span>
</span><a name="line-94"></a><span class="hs-identifier">dimCoords</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="LightsOut.html#Dim"><span class="hs-identifier hs-type">Dim</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="LightsOut.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span class="hs-special">]</span><span>
</span><a name="line-95"></a><a name="dimCoords"><a href="LightsOut.html#dimCoords"><span class="hs-identifier">dimCoords</span></a></a><span> </span><span class="hs-special">(</span><a href="LightsOut.html#Dim"><span class="hs-identifier hs-var">Dim</span></a><span> </span><a name="local-6989586621679105875"><a href="#local-6989586621679105875"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679105876"><a href="#local-6989586621679105876"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="LightsOut.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679105877"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105878"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679105877"><a href="#local-6989586621679105877"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679105875"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679105878"><a href="#local-6989586621679105878"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679105876"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- | Generate a map associating coordinates that can be toggled with</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- whether or not that coordinate was toggled.</span><span>
</span><a name="line-101"></a><span class="hs-identifier">existsSolution</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="LightsOut.html#Dim"><span class="hs-identifier hs-type">Dim</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Ersatz.Prelude.html#Ersatz"><span class="hs-identifier hs-type">Ersatz</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="LightsOut.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><a name="existsSolution"><a href="LightsOut.html#existsSolution"><span class="hs-identifier">existsSolution</span></a></a><span> </span><a name="local-6989586621679105879"><a href="#local-6989586621679105879"><span class="hs-identifier">dim</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.Traversable.html#sequenceA"><span class="hs-identifier hs-var">sequenceA</span></a><span> </span><a href="#local-6989586621679105880"><span class="hs-identifier hs-var">mapOfExists</span></a><span>
</span><a name="line-103"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-identifier">mapOfExists</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="LightsOut.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><span class="hs-special">(</span><a href="Ersatz.Prelude.html#Ersatz"><span class="hs-identifier hs-type">Ersatz</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>    </span><a name="local-6989586621679105880"><a href="#local-6989586621679105880"><span class="hs-identifier">mapOfExists</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679105881"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Ersatz.Prelude.html#exists"><span class="hs-identifier hs-var">exists</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679105881"><a href="#local-6989586621679105881"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="LightsOut.html#dimCoords"><span class="hs-identifier hs-var">dimCoords</span></a><span> </span><a href="#local-6989586621679105879"><span class="hs-identifier hs-var">dim</span></a><span class="hs-special">]</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- | Predicate for determining if a set of toggles results in all</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- lights being turned off. A clicked coordinate corresponds to an</span><span>
</span><a name="line-111"></a><span class="hs-comment">-- entry in the given map with a 'true' value.</span><span>
</span><a name="line-112"></a><span class="hs-identifier">isValidSolution</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-113"></a><span>  </span><a href="LightsOut.html#LightsOut"><span class="hs-identifier hs-type">LightsOut</span></a><span>     </span><span class="hs-comment">{- ^ puzzle              -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-114"></a><span>  </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="LightsOut.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span> </span><span class="hs-comment">{- ^ clicked coordinates -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-115"></a><span>  </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span>           </span><span class="hs-comment">{- ^ solution is valid   -}</span><span>
</span><a name="line-116"></a><a name="isValidSolution"><a href="LightsOut.html#isValidSolution"><span class="hs-identifier">isValidSolution</span></a></a><span> </span><a name="local-6989586621679105882"><a href="#local-6989586621679105882"><span class="hs-identifier">puzzle</span></a></a><span> </span><a name="local-6989586621679105883"><a href="#local-6989586621679105883"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679105884"><span class="hs-identifier hs-var">allOff</span></a><span>
</span><a name="line-117"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-118"></a><span>    </span><a name="local-6989586621679105884"><a href="#local-6989586621679105884"><span class="hs-identifier">allOff</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#not"><span class="hs-identifier hs-var">not</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679105887"><span class="hs-identifier hs-var">isOn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#keys"><span class="hs-identifier hs-var">Map.keys</span></a><span> </span><a href="#local-6989586621679105883"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span>    </span><a name="local-6989586621679105885"><a href="#local-6989586621679105885"><span class="hs-identifier">initialState</span></a></a><span> </span><a name="local-6989586621679105888"><a href="#local-6989586621679105888"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#bool"><span class="hs-identifier hs-var">bool</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105888"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">Set.member</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">lightsOn</span><span> </span><a href="#local-6989586621679105882"><span class="hs-identifier hs-var">puzzle</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span>    </span><a name="local-6989586621679105886"><a href="#local-6989586621679105886"><span class="hs-identifier">isClicked</span></a></a><span>    </span><a name="local-6989586621679105889"><a href="#local-6989586621679105889"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#findWithDefault"><span class="hs-identifier hs-var">Map.findWithDefault</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#false"><span class="hs-identifier hs-var">false</span></a><span> </span><a href="#local-6989586621679105889"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679105883"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>    </span><a name="local-6989586621679105887"><a href="#local-6989586621679105887"><span class="hs-identifier">isOn</span></a></a><span>         </span><a name="local-6989586621679105890"><a href="#local-6989586621679105890"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#xor"><span class="hs-identifier hs-var">xor</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679105885"><span class="hs-identifier hs-var">initialState</span></a><span> </span><a href="#local-6989586621679105890"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>                   </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679105886"><span class="hs-identifier hs-var">isClicked</span></a><span>
</span><a name="line-126"></a><span>                   </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="LightsOut.html#neighborhood"><span class="hs-identifier hs-var">neighborhood</span></a><span> </span><a href="#local-6989586621679105890"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- | Find a solution to the given puzzle that also satisfies</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- an additional predicate if one exists.</span><span>
</span><a name="line-132"></a><span class="hs-comment">--</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- &gt;&gt;&gt; findSolution smallLightsOut</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- Just (fromList [(C 1 1,True),(C 1 2,False),(C 1 3,False),(C 2 1,False),(C 2 2,False),(C 2 3,False),(C 3 1,False),(C 3 2,False),(C 3 3,True)])</span><span>
</span><a name="line-135"></a><span class="hs-identifier">findSolution</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-136"></a><span>  </span><a href="LightsOut.html#LightsOut"><span class="hs-identifier hs-type">LightsOut</span></a><span>                   </span><span class="hs-comment">{- ^ puzzle                 -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-137"></a><span>  </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="LightsOut.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">{- ^ solution if one exists -}</span><span>
</span><a name="line-138"></a><a name="findSolution"><a href="LightsOut.html#findSolution"><span class="hs-identifier">findSolution</span></a></a><span> </span><a name="local-6989586621679105891"><a href="#local-6989586621679105891"><span class="hs-identifier">puzzle</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-139"></a><span>  </span><a href="Ersatz.Prelude.html#solve"><span class="hs-identifier hs-var">solve</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-140"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679105892"><a href="#local-6989586621679105892"><span class="hs-identifier">soln</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="LightsOut.html#existsSolution"><span class="hs-identifier hs-var">existsSolution</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">dimensions</span><span> </span><a href="#local-6989586621679105891"><span class="hs-identifier hs-var">puzzle</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>       </span><a href="Ersatz.Prelude.html#assert"><span class="hs-identifier hs-var">assert</span></a><span> </span><span class="hs-special">(</span><a href="LightsOut.html#isValidSolution"><span class="hs-identifier hs-var">isValidSolution</span></a><span> </span><a href="#local-6989586621679105891"><span class="hs-identifier hs-var">puzzle</span></a><span> </span><a href="#local-6989586621679105892"><span class="hs-identifier hs-var">soln</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>       </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679105892"><span class="hs-identifier hs-var">soln</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- | Attempt to solve the given puzzle and print the solution to stdout.</span><span>
</span><a name="line-146"></a><span class="hs-comment">--</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- &gt;&gt;&gt; lightsOut smallLightsOut </span><span>
</span><a name="line-148"></a><span class="hs-comment">-- *..</span><span>
</span><a name="line-149"></a><span class="hs-comment">-- ...</span><span>
</span><a name="line-150"></a><span class="hs-comment">-- ..*</span><span>
</span><a name="line-151"></a><span class="hs-identifier">lightsOut</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-152"></a><span>  </span><a href="LightsOut.html#LightsOut"><span class="hs-identifier hs-type">LightsOut</span></a><span> </span><span class="hs-comment">{- ^ puzzle                   -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-153"></a><span>  </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">{- ^ print solution to puzzle -}</span><span>
</span><a name="line-154"></a><a name="lightsOut"><a href="LightsOut.html#lightsOut"><span class="hs-identifier">lightsOut</span></a></a><span> </span><a name="local-6989586621679105893"><a href="#local-6989586621679105893"><span class="hs-identifier">puzzle</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679105894"><a href="#local-6989586621679105894"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="LightsOut.html#findSolution"><span class="hs-identifier hs-var">findSolution</span></a><span> </span><a href="#local-6989586621679105893"><span class="hs-identifier hs-var">puzzle</span></a><span>
</span><a name="line-156"></a><span>     </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679105894"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-157"></a><span>       </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a><span> </span><span class="hs-string">&quot;No solution&quot;</span><span>
</span><a name="line-158"></a><span>       </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679105895"><a href="#local-6989586621679105895"><span class="hs-identifier">solution</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-159"></a><span>         </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/System.IO.html#putStr"><span class="hs-identifier hs-var">putStr</span></a><span> </span><span class="hs-special">(</span><a href="LightsOut.html#renderSolution"><span class="hs-identifier hs-var">renderSolution</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">dimensions</span><span> </span><a href="#local-6989586621679105893"><span class="hs-identifier hs-var">puzzle</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679105895"><span class="hs-identifier hs-var">solution</span></a><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- | Parse a lights out puzzle encoded as lines of @.@ for off and</span><span>
</span><a name="line-165"></a><span class="hs-comment">-- @*@ for on.</span><span>
</span><a name="line-166"></a><span class="hs-comment">--</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- Example input</span><span>
</span><a name="line-168"></a><span class="hs-comment">--</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-170"></a><span class="hs-comment">-- *.*.</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- .*..</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- ...*</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-174"></a><span class="hs-comment">--</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- &gt;&gt;&gt; parsePuzzle &quot;*.*.\n.*..\n...*\n&quot;</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- LightsOut {dimensions = Dim 4 3, lightsOn = fromList [C 1 1,C 2 2,C 3 1,C 4 3]}</span><span>
</span><a name="line-177"></a><span class="hs-identifier">parsePuzzle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="LightsOut.html#LightsOut"><span class="hs-identifier hs-type">LightsOut</span></a><span>
</span><a name="line-178"></a><a name="parsePuzzle"><a href="LightsOut.html#parsePuzzle"><span class="hs-identifier">parsePuzzle</span></a></a><span> </span><a name="local-6989586621679105896"><a href="#local-6989586621679105896"><span class="hs-identifier">input</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="LightsOut.html#LightsOut"><span class="hs-identifier hs-var">LightsOut</span></a><span> </span><span class="hs-special">(</span><a href="LightsOut.html#Dim"><span class="hs-identifier hs-var">Dim</span></a><span> </span><a href="#local-6989586621679105898"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679105899"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a><span> </span><a href="#local-6989586621679105900"><span class="hs-identifier hs-var">coords</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-180"></a><span>    </span><a name="local-6989586621679105897"><a href="#local-6989586621679105897"><span class="hs-identifier">rows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.OldList.html#lines"><span class="hs-identifier hs-var">lines</span></a><span> </span><a href="#local-6989586621679105896"><span class="hs-identifier hs-var">input</span></a><span>
</span><a name="line-181"></a><span>    </span><a name="local-6989586621679105898"><a href="#local-6989586621679105898"><span class="hs-identifier">w</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.Foldable.html#maximum"><span class="hs-identifier hs-var">maximum</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679105897"><span class="hs-identifier hs-var">rows</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>    </span><a name="local-6989586621679105899"><a href="#local-6989586621679105899"><span class="hs-identifier">h</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679105897"><span class="hs-identifier hs-var">rows</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span>    </span><a name="local-6989586621679105900"><a href="#local-6989586621679105900"><span class="hs-identifier">coords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="LightsOut.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679105903"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105901"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679105901"><a href="#local-6989586621679105901"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679105902"><a href="#local-6989586621679105902"><span class="hs-identifier">row</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679105897"><span class="hs-identifier hs-var">rows</span></a><span>
</span><a name="line-185"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679105903"><a href="#local-6989586621679105903"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span class="hs-char">'*'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679105902"><span class="hs-identifier hs-var">row</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- | Render a lights out puzzle using @.@ and @*@ as in 'parsePuzzle'.</span><span>
</span><a name="line-189"></a><span class="hs-identifier">renderSolution</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-190"></a><span>  </span><a href="LightsOut.html#Dim"><span class="hs-identifier hs-type">Dim</span></a><span>            </span><span class="hs-comment">{- ^ board dimensions  -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-191"></a><span>  </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a><span> </span><a href="LightsOut.html#Coord"><span class="hs-identifier hs-type">Coord</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span> </span><span class="hs-comment">{- ^ solution map      -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-192"></a><span>  </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>         </span><span class="hs-comment">{- ^ rendered solution -}</span><span>
</span><a name="line-193"></a><a name="renderSolution"><a href="LightsOut.html#renderSolution"><span class="hs-identifier">renderSolution</span></a></a><span> </span><span class="hs-special">(</span><a href="LightsOut.html#Dim"><span class="hs-identifier hs-var">Dim</span></a><span> </span><a name="local-6989586621679105904"><a href="#local-6989586621679105904"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679105905"><a href="#local-6989586621679105905"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679105906"><a href="#local-6989586621679105906"><span class="hs-identifier">coords</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-194"></a><span>  </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a><span>
</span><a name="line-195"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679105906"><span class="hs-identifier hs-var">coords</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/cntnrs-0.5.11.0-4aabb02b/share/doc/html/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">Map.!</span></a><span> </span><a href="LightsOut.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679105908"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679105907"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-char">'*'</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-char">'.'</span><span>
</span><a name="line-196"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679105908"><a href="#local-6989586621679105908"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><a href="#local-6989586621679105904"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-glyph">|</span><span>  </span><a name="local-6989586621679105907"><a href="#local-6989586621679105907"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><a href="#local-6989586621679105905"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-198"></a></pre></body></html>