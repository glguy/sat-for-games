<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# Language TypeFamilies #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{-|
Module      : Count
Description : Symbolic operations for counting increments and decrements.
Copyright   : (c) Eric Mertens, 2018
License     : ISC
Maintainer  : emertens@gmail.com

This type allows us to symbolically count numbers incrementing and decrementing
by one. Counts can be ordered and compared for equality.

Use 'encode' to make constant valued counts.

Use 'increment', 'decrement', and 'addBit' to update 'Count' values.

&gt;&gt;&gt; :{
solve $
  do (x,y,z) &lt;- exists
     let count = foldr addBit (encode 0)
     assert (count [x,y,z] === encode 2)
     assert (count [x,  z] === encode 1)
     assert (count [  y,z] === encode 1)
     return (x,y,z)
:}
Just (True,True,False)

-}</span><span>
</span><a name="line-28"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Count</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Count.html#increment"><span class="hs-identifier hs-var">increment</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Count.html#decrement"><span class="hs-identifier hs-var">decrement</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Count.html#addBit"><span class="hs-identifier hs-var">addBit</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-comment">-- base</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#mzero"><span class="hs-identifier hs-var">mzero</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.OldList.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">-- sat-for-games</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="Ersatz.Prelude.html"><span class="hs-identifier">Ersatz.Prelude</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="Choice.html"><span class="hs-identifier">Choice</span></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- | This type represents a natural number and supports operations like</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- increment and comparison.</span><span>
</span><a name="line-46"></a><span class="hs-keyword">newtype</span><span> </span><a name="Count"><a href="Count.html#Count"><span class="hs-identifier">Count</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Count"><a href="Count.html#Count"><span class="hs-identifier">Count</span></a></a><span> </span><span class="hs-special">[</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- Invariant: exactly one bit in the list must be true</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- | 'encode' treats negative inputs as zero</span><span>
</span><a name="line-52"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Codec.html#Codec"><span class="hs-identifier hs-type">Codec</span></a><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Decoded</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span>  </span><a name="local-8214565720323801281"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Codec.html#encode"><span class="hs-identifier">encode</span></a></a><span> </span><a name="local-6989586621679068220"><a href="#local-6989586621679068220"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span> </span><a href="#local-6989586621679068220"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#false"><span class="hs-identifier hs-var">false</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#true"><span class="hs-identifier hs-var">true</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>  </span><a name="local-8214565720323801282"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Codec.html#decode"><span class="hs-identifier">decode</span></a></a><span> </span><a name="local-6989586621679068221"><a href="#local-6989586621679068221"><span class="hs-identifier">sol</span></a></a><span> </span><span class="hs-special">(</span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><a name="local-6989586621679068222"><a href="#local-6989586621679068222"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-59"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679068223"><a href="#local-6989586621679068223"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Codec.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679068221"><span class="hs-identifier hs-var">sol</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679068222"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-60"></a><span>       </span><span class="hs-keyword">case</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.OldList.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a><span> </span><a href="#local-6989586621679068223"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-61"></a><span>         </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#mzero"><span class="hs-identifier hs-var">mzero</span></a><span>
</span><a name="line-62"></a><span>         </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679068224"><a href="#local-6989586621679068224"><span class="hs-identifier">i</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679068224"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-keyword">instance</span><span> </span><a href="Choice.html#Choice"><span class="hs-identifier hs-type">Choice</span></a><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-67"></a><span>  </span><a name="local-8214565720323818405"><a href="Choice.html#choice"><span class="hs-identifier">choice</span></a></a><span> </span><span class="hs-special">(</span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><a name="local-6989586621679068210"><a href="#local-6989586621679068210"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><a name="local-6989586621679068211"><a href="#local-6989586621679068211"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679068212"><a href="#local-6989586621679068212"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679068213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679068210"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679068211"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-69"></a><span>      </span><a name="local-6989586621679068213"><a href="#local-6989586621679068213"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679068214"><a href="#local-6989586621679068214"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068215"><a href="#local-6989586621679068215"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679068216"><a href="#local-6989586621679068216"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068217"><a href="#local-6989586621679068217"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Choice.html#choice"><span class="hs-identifier hs-var">choice</span></a><span> </span><a href="#local-6989586621679068214"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679068216"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679068212"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679068213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679068215"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679068217"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-70"></a><span>      </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679068218"><a href="#local-6989586621679068218"><span class="hs-identifier">xs</span></a></a><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#not"><span class="hs-identifier hs-var">not</span></a><span> </span><a href="#local-6989586621679068212"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679068218"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-71"></a><span>      </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="local-6989586621679068219"><a href="#local-6989586621679068219"><span class="hs-identifier">ys</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span>    </span><a href="#local-6989586621679068212"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679068219"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-comment">-- | Increment the value of a 'Count' by one.</span><span>
</span><a name="line-76"></a><span class="hs-identifier">increment</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span>
</span><a name="line-77"></a><a name="increment"><a href="Count.html#increment"><span class="hs-identifier">increment</span></a></a><span> </span><span class="hs-special">(</span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><a name="local-6989586621679068225"><a href="#local-6989586621679068225"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#false"><span class="hs-identifier hs-var">false</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679068225"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- | Decrement the value of a 'Count' by one. Decrement of zero is zero.</span><span>
</span><a name="line-80"></a><span class="hs-identifier">decrement</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span>
</span><a name="line-81"></a><a name="decrement"><a href="Count.html#decrement"><span class="hs-identifier">decrement</span></a></a><span> </span><span class="hs-special">(</span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><a name="local-6989586621679068226"><a href="#local-6989586621679068226"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679068226"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-83"></a><span>    </span><a name="local-6989586621679068227"><a href="#local-6989586621679068227"><span class="hs-identifier">b0</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068228"><a href="#local-6989586621679068228"><span class="hs-identifier">b1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068229"><a href="#local-6989586621679068229"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679068227"><span class="hs-identifier hs-var">b0</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#%7C%7C"><span class="hs-operator hs-var">||</span></a><span> </span><a href="#local-6989586621679068228"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679068229"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><span class="hs-special">[</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#true"><span class="hs-identifier hs-var">true</span></a><span class="hs-special">]</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | Add a bit representing a zero or one to the count.</span><span>
</span><a name="line-87"></a><span class="hs-identifier">addBit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span>
</span><a name="line-88"></a><a name="addBit"><a href="Count.html#addBit"><span class="hs-identifier">addBit</span></a></a><span> </span><a name="local-6989586621679068230"><a href="#local-6989586621679068230"><span class="hs-identifier">bit</span></a></a><span> </span><a name="local-6989586621679068231"><a href="#local-6989586621679068231"><span class="hs-identifier">count</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Choice.html#choice"><span class="hs-identifier hs-var">choice</span></a><span> </span><a href="#local-6989586621679068231"><span class="hs-identifier hs-var">count</span></a><span> </span><span class="hs-special">(</span><a href="Count.html#increment"><span class="hs-identifier hs-var">increment</span></a><span> </span><a href="#local-6989586621679068231"><span class="hs-identifier hs-var">count</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679068230"><span class="hs-identifier hs-var">bit</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Equatable.html#Equatable"><span class="hs-identifier hs-type">Equatable</span></a><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-93"></a><span>  </span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><a name="local-6989586621679068208"><a href="#local-6989586621679068208"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-8214565720323801180"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Equatable.html#%3D%3D%3D"><span class="hs-operator">===</span></a></a><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><a name="local-6989586621679068209"><a href="#local-6989586621679068209"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#and"><span class="hs-identifier hs-var">and</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Equatable.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679068208"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679068209"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-comment">-- | Construct a comparison on 'Count' given a function with access to</span><span>
</span><a name="line-98"></a><span class="hs-comment">-- three pieces of information:</span><span>
</span><a name="line-99"></a><span class="hs-comment">--</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- 1. Is the left argument zero?</span><span>
</span><a name="line-101"></a><span class="hs-comment">--</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- 2. Is the right argument zero?</span><span>
</span><a name="line-103"></a><span class="hs-comment">--</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- 3. When neither argument is zero, what is the result of comparing</span><span>
</span><a name="line-105"></a><span class="hs-comment">--    each number decremented by one.</span><span>
</span><a name="line-106"></a><span class="hs-identifier">foldComparison</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-107"></a><span>  </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span>                        </span><span class="hs-comment">{- ^ base case                                   -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-special">(</span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{- ^ left is zero, right is zero, recursive case -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-109"></a><span>  </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#Bit"><span class="hs-identifier hs-type">Bit</span></a><span>      </span><span class="hs-comment">{- ^ comparison function                         -}</span><span>
</span><a name="line-110"></a><a name="foldComparison"><a href="Count.html#foldComparison"><span class="hs-identifier">foldComparison</span></a></a><span> </span><a name="local-6989586621679068232"><a href="#local-6989586621679068232"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679068233"><a href="#local-6989586621679068233"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><a name="local-6989586621679068234"><a href="#local-6989586621679068234"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Count.html#Count"><span class="hs-identifier hs-var">Count</span></a><span> </span><a name="local-6989586621679068235"><a href="#local-6989586621679068235"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a><span> </span><a href="#local-6989586621679068233"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679068232"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">(</span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><a href="#local-6989586621679068234"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679068235"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-keyword">instance</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Orderable.html#Orderable"><span class="hs-identifier hs-type">Orderable</span></a><span> </span><a href="Count.html#Count"><span class="hs-identifier hs-type">Count</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720323801156"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Orderable.html#%3C%3F"><span class="hs-operator">&lt;?</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Count.html#foldComparison"><span class="hs-identifier hs-var">foldComparison</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#false"><span class="hs-identifier hs-var">false</span></a><span> </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679068202"><a href="#local-6989586621679068202"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679068203"><a href="#local-6989586621679068203"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679068204"><a href="#local-6989586621679068204"><span class="hs-identifier">next</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#not"><span class="hs-identifier hs-var">not</span></a><span> </span><a href="#local-6989586621679068203"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679068202"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#%7C%7C"><span class="hs-operator hs-var">||</span></a><span> </span><a href="#local-6989586621679068204"><span class="hs-identifier hs-var">next</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720323801155"><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Orderable.html#%3C%3D%3F"><span class="hs-operator">&lt;=?</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Count.html#foldComparison"><span class="hs-identifier hs-var">foldComparison</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#true"><span class="hs-identifier hs-var">true</span></a><span>  </span><a href="file:///Users/emertens/Tools/ghc-8.6.1/share/doc/ghc-8.6.1/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679068205"><a href="#local-6989586621679068205"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679068206"><a href="#local-6989586621679068206"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679068207"><a href="#local-6989586621679068207"><span class="hs-identifier">next</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068205"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#%7C%7C"><span class="hs-operator hs-var">||</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#not"><span class="hs-identifier hs-var">not</span></a><span> </span><a href="#local-6989586621679068206"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="file:///Users/emertens/.cabal/store/ghc-8.6.1/rstz-0.4.4-b4c0a41d/share/doc/html/src/Ersatz.Bit.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><a href="#local-6989586621679068207"><span class="hs-identifier hs-var">next</span></a><span>
</span><a name="line-115"></a></pre></body></html>